---
title: "Cloud Vulnerability Triage & Contextualization"
type: "runbook"
category: "security_operations"
status: "active"
tags:
  - vulnerability_management
  - cloud_security
  - triage
  - cve_enrichment
---

## Cloud Vulnerability Triage & Contextualization

Objective: Triage top critical/high SCC vulnerability findings for a given project (`${PROJECT_ID}`). Enrich the CVEs with GTI, check for related exploitation activity in SIEM, and summarize findings for remediation prioritization, potentially adding context to a SOAR case.

Uses Tools:

*   `scc-mcp.top_vulnerability_findings`
*   `scc-mcp.get_finding_remediation`
*   `gti-mcp.search_vulnerabilities` (or `get_threat_intel` for CVE summary)
*   `secops-mcp.search_security_events`
*   `secops-mcp.lookup_entity` (for affected resource)
*   `secops-soar.post_case_comment` (optional)
*   **Action:** Request user input (e.g., using `ask_followup_question`)

```mermaid
sequenceDiagram
    participant User
    participant Cline as Cline (MCP Client)
    participant SCC as scc-mcp
    participant GTI as gti-mcp
    participant SIEM as secops-mcp
    participant SOAR as secops-soar %% Underlying tool for documentation
    participant ConfirmAction as common_steps/confirm_action.md
    participant DocumentInSOAR as common_steps/document_in_soar.md

    User->>Cline: Triage top vulnerabilities for project `${PROJECT_ID}`
    Cline->>SCC: top_vulnerability_findings(project_id=`${PROJECT_ID}`, max_findings=5)
    SCC-->>Cline: List of Top Findings (F1, F2... with CVE, Resource, Score)

    Note over Cline: Initialize triage_report
    loop For each Finding Fi
        Note over Cline: Extract CVE Ci and Resource Ri from Finding Fi
        Cline->>SCC: get_finding_remediation(finding_id=Fi_ID)
        SCC-->>Cline: Remediation Steps for Fi
        Note over Cline: Add remediation to triage_report

        Cline->>GTI: search_vulnerabilities(query=Ci)
        GTI-->>Cline: GTI details for CVE Ci (Exploitation status, related threats)
        Note over Cline: Add GTI context to triage_report

        Cline->>SIEM: lookup_entity(entity_value=Ri, hours_back=168) %% Check resource activity (e.g., IP/hostname) for 7 days
        SIEM-->>Cline: SIEM Summary for Resource Ri
        Note over Cline: Add resource activity summary to triage_report

        Cline->>SIEM: search_security_events(text="Events related to CVE Ci or exploitation attempts on Ri", hours_back=168)
        SIEM-->>Cline: Potential exploitation events
        Note over Cline: Add relevant event findings to triage_report
    end

    Note over Cline: Synthesize triage_report with findings, context, and prioritization based on Score/GTI/SIEM data

    %% Optional: Confirm SOAR Update
    Cline->>ConfirmAction: Request user input (QUESTION_TEXT="Triage complete...", RESPONSE_OPTIONS=...)
    ConfirmAction-->>Cline: Results: USER_RESPONSE

    %% Optional: Document in SOAR
    alt USER_RESPONSE contains "Yes" %% Assumes format "Yes, Case [ID]"
        Note over Cline: Extract CASE_ID from USER_RESPONSE
        Note over Cline: Prepare COMMENT_TEXT for SOAR
        Cline->>DocumentInSOAR: Execute(Input: CASE_ID, COMMENT_TEXT="SCC Vuln Triage Summary...")
        DocumentInSOAR-->>Cline: Results: COMMENT_POST_STATUS
    end

    Cline->>Cline: Conclude runbook (result="Cloud vulnerability triage for project `${PROJECT_ID}` complete. Findings synthesized. SOAR case potentially updated.")

## Runbook Conclusion
*   **Action:** Generate a Mermaid sequence diagram summarizing the specific actions taken during this execution.
*   **Action:** Record the current date and time of execution.
*   **Action:** (Optional) Record the token usage and runtime duration if available from the environment.
*   Conclude the runbook execution.

## Rubric

### 1. Finding Retrieval (20 Points)
*   **Top Findings (20 Points):** Did the agent correctly use `scc-mcp.top_vulnerability_findings` to retrieve the most critical vulnerabilities for the specified project?

### 2. Context & Enrichment (30 Points)
*   **CVE Enrichment (10 Points):** Did the agent query GTI (`gti-mcp`) for threat intelligence on the identified CVEs?
*   **Resource Activity (10 Points):** Did the agent check the SIEM (`secops-mcp`) for recent activity on the affected resources?
*   **Exploitation Check (10 Points):** Did the agent search the SIEM for signs of active exploitation related to the CVEs?

### 3. Synthesis (20 Points)
*   **Prioritization (20 Points):** Did the agent provide a clear summary or ranking of which vulnerabilities require immediate attention based on the combined SCC severity, GTI threat intel, and SIEM activity?

### 4. Visual Summary (10 Points)
*   **Sequence Diagram (10 Points):** Did the agent produce a valid Mermaid sequence diagram summarizing the actions taken during the execution?

### 5. Operational Metadata (10 Points)
*   **Date/Time (5 Points):** Did the agent record the date and time of the execution?
*   **Cost/Runtime (5 Points):** Did the agent attempt to record token usage and runtime duration (or note if unavailable)?

### 6. Resilience & Quality (10 Points)
*   **Error Handling (5 Points):** Did the agent handle any tool failures or invalid inputs gracefully without crashing or hallucinating?
*   **Output Formatting (5 Points):** Is the final output well-structured and free of internal monologue artifacts?

### Critical Failures (Automatic Failure)
*   Failing to identify the target project ID.
*   Hallucinating vulnerabilities or threat intelligence.
*   Ignoring a Critical vulnerability that has known active exploitation.
